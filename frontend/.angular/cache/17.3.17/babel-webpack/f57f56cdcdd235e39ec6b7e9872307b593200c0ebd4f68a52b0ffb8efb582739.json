{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"../../services/client-api.service\";\nimport * as i4 from \"@angular/common\";\nfunction ClientFormPageComponent_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 28);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(ctx_r0.error);\n  }\n}\nfunction ClientFormPageComponent_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 29);\n    i0.ɵɵtext(1, \"Loading...\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ClientFormPageComponent_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 30);\n    i0.ɵɵtext(1, \" Client Ref is required. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ClientFormPageComponent_div_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 30);\n    i0.ɵɵtext(1, \" Full Name is required. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ClientFormPageComponent_div_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 30);\n    i0.ɵɵtext(1, \" Provide a valid email. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ClientFormPageComponent_div_32_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 30);\n    i0.ɵɵtext(1, \" Phone is required. \");\n    i0.ɵɵelementEnd();\n  }\n}\nexport let ClientFormPageComponent = /*#__PURE__*/(() => {\n  class ClientFormPageComponent {\n    constructor(fb, route, router, api) {\n      this.fb = fb;\n      this.route = route;\n      this.router = router;\n      this.api = api;\n      this.mode = 'create';\n      this.clientId = null;\n      this.loading = false;\n      this.saving = false;\n      this.error = null;\n      this.form = this.fb.group({\n        clientRef: ['', [Validators.required, Validators.maxLength(30)]],\n        fullName: ['', [Validators.required, Validators.maxLength(120)]],\n        email: ['', [Validators.required, Validators.email]],\n        phone: ['', [Validators.required, Validators.maxLength(40)]],\n        riskCategory: ['Medium', [Validators.required]],\n        classification: ['Standard', [Validators.required, Validators.maxLength(50)]],\n        advisor: ['', [Validators.required, Validators.maxLength(80)]],\n        notes: ['']\n      });\n    }\n    ngOnInit() {\n      const id = this.route.snapshot.paramMap.get('id');\n      if (id) {\n        this.mode = 'edit';\n        this.clientId = id;\n        this.loadClient(id);\n      }\n    }\n    loadClient(id) {\n      this.loading = true;\n      this.api.get(id).subscribe({\n        next: c => {\n          this.form.patchValue({\n            clientRef: c.clientRef,\n            fullName: c.fullName,\n            email: c.email,\n            phone: c.phone,\n            riskCategory: c.riskCategory,\n            classification: c.classification,\n            advisor: c.advisor,\n            notes: c.notes || ''\n          });\n          // Keep clientRef editable? If you want it immutable, disable here.\n          this.loading = false;\n        },\n        error: err => {\n          this.error = err?.error?.message ?? 'Failed to load client';\n          this.loading = false;\n        }\n      });\n    }\n    save() {\n      if (this.form.invalid) {\n        this.form.markAllAsTouched();\n        return;\n      }\n      this.saving = true;\n      this.error = null;\n      const payload = this.form.getRawValue();\n      if (this.mode === 'create') {\n        this.api.create(payload).subscribe({\n          next: created => {\n            this.saving = false;\n            this.router.navigate(['/clients', created._id]);\n          },\n          error: err => {\n            this.error = err?.error?.message ?? 'Failed to create client';\n            this.saving = false;\n          }\n        });\n      } else {\n        if (!this.clientId) return;\n        this.api.update(this.clientId, payload).subscribe({\n          next: updated => {\n            this.saving = false;\n            this.router.navigate(['/clients', updated._id]);\n          },\n          error: err => {\n            this.error = err?.error?.message ?? 'Failed to update client';\n            this.saving = false;\n          }\n        });\n      }\n    }\n    static {\n      this.ɵfac = function ClientFormPageComponent_Factory(t) {\n        return new (t || ClientFormPageComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.ClientApiService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: ClientFormPageComponent,\n        selectors: [[\"app-client-form-page\"]],\n        decls: 58,\n        vars: 10,\n        consts: [[1, \"d-flex\", \"align-items-center\", \"justify-content-between\", \"mb-3\"], [1, \"mb-0\"], [1, \"text-muted\"], [\"routerLink\", \"/clients\", 1, \"btn\", \"btn-outline-secondary\"], [\"class\", \"alert alert-danger\", 4, \"ngIf\"], [\"class\", \"alert alert-info\", 4, \"ngIf\"], [1, \"card\", 3, \"ngSubmit\", \"formGroup\"], [1, \"card-body\"], [1, \"row\", \"g-3\"], [1, \"col-md-4\"], [1, \"form-label\"], [\"formControlName\", \"clientRef\", \"placeholder\", \"NS-0001\", 1, \"form-control\"], [\"class\", \"text-danger small\", 4, \"ngIf\"], [1, \"col-md-8\"], [\"formControlName\", \"fullName\", \"placeholder\", \"Jane Doe\", 1, \"form-control\"], [1, \"col-md-6\"], [\"formControlName\", \"email\", \"placeholder\", \"jane.doe@northstar.com\", 1, \"form-control\"], [\"formControlName\", \"phone\", \"placeholder\", \"(416) 555-0100\", 1, \"form-control\"], [\"formControlName\", \"riskCategory\", 1, \"form-select\"], [\"value\", \"Low\"], [\"value\", \"Medium\"], [\"value\", \"High\"], [\"formControlName\", \"classification\", \"placeholder\", \"Standard\", 1, \"form-control\"], [\"formControlName\", \"advisor\", \"placeholder\", \"Advisor Name\", 1, \"form-control\"], [1, \"col-12\"], [\"rows\", \"4\", \"formControlName\", \"notes\", \"placeholder\", \"Operational notes for advisor/compliance\", 1, \"form-control\"], [1, \"card-footer\", \"d-flex\", \"justify-content-end\", \"gap-2\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", 3, \"disabled\"], [1, \"alert\", \"alert-danger\"], [1, \"alert\", \"alert-info\"], [1, \"text-danger\", \"small\"]],\n        template: function ClientFormPageComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\")(2, \"h2\", 1);\n            i0.ɵɵtext(3);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(4, \"div\", 2);\n            i0.ɵɵtext(5, \"Client record management\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(6, \"a\", 3);\n            i0.ɵɵtext(7, \"Back\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵtemplate(8, ClientFormPageComponent_div_8_Template, 2, 1, \"div\", 4)(9, ClientFormPageComponent_div_9_Template, 2, 0, \"div\", 5);\n            i0.ɵɵelementStart(10, \"form\", 6);\n            i0.ɵɵlistener(\"ngSubmit\", function ClientFormPageComponent_Template_form_ngSubmit_10_listener() {\n              return ctx.save();\n            });\n            i0.ɵɵelementStart(11, \"div\", 7)(12, \"div\", 8)(13, \"div\", 9)(14, \"label\", 10);\n            i0.ɵɵtext(15, \"Client Ref\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(16, \"input\", 11);\n            i0.ɵɵtemplate(17, ClientFormPageComponent_div_17_Template, 2, 0, \"div\", 12);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(18, \"div\", 13)(19, \"label\", 10);\n            i0.ɵɵtext(20, \"Full Name\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(21, \"input\", 14);\n            i0.ɵɵtemplate(22, ClientFormPageComponent_div_22_Template, 2, 0, \"div\", 12);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(23, \"div\", 15)(24, \"label\", 10);\n            i0.ɵɵtext(25, \"Email\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(26, \"input\", 16);\n            i0.ɵɵtemplate(27, ClientFormPageComponent_div_27_Template, 2, 0, \"div\", 12);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(28, \"div\", 15)(29, \"label\", 10);\n            i0.ɵɵtext(30, \"Phone\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(31, \"input\", 17);\n            i0.ɵɵtemplate(32, ClientFormPageComponent_div_32_Template, 2, 0, \"div\", 12);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(33, \"div\", 9)(34, \"label\", 10);\n            i0.ɵɵtext(35, \"Risk Category\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(36, \"select\", 18)(37, \"option\", 19);\n            i0.ɵɵtext(38, \"Low\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(39, \"option\", 20);\n            i0.ɵɵtext(40, \"Medium\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(41, \"option\", 21);\n            i0.ɵɵtext(42, \"High\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(43, \"div\", 9)(44, \"label\", 10);\n            i0.ɵɵtext(45, \"Classification\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(46, \"input\", 22);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(47, \"div\", 9)(48, \"label\", 10);\n            i0.ɵɵtext(49, \"Advisor\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(50, \"input\", 23);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(51, \"div\", 24)(52, \"label\", 10);\n            i0.ɵɵtext(53, \"Notes\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(54, \"textarea\", 25);\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(55, \"div\", 26)(56, \"button\", 27);\n            i0.ɵɵtext(57);\n            i0.ɵɵelementEnd()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(3);\n            i0.ɵɵtextInterpolate(ctx.mode === \"create\" ? \"New Client\" : \"Edit Client\");\n            i0.ɵɵadvance(5);\n            i0.ɵɵproperty(\"ngIf\", ctx.error);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.loading);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"formGroup\", ctx.form);\n            i0.ɵɵadvance(7);\n            i0.ɵɵproperty(\"ngIf\", ctx.form.controls.clientRef.touched && ctx.form.controls.clientRef.invalid);\n            i0.ɵɵadvance(5);\n            i0.ɵɵproperty(\"ngIf\", ctx.form.controls.fullName.touched && ctx.form.controls.fullName.invalid);\n            i0.ɵɵadvance(5);\n            i0.ɵɵproperty(\"ngIf\", ctx.form.controls.email.touched && ctx.form.controls.email.invalid);\n            i0.ɵɵadvance(5);\n            i0.ɵɵproperty(\"ngIf\", ctx.form.controls.phone.touched && ctx.form.controls.phone.invalid);\n            i0.ɵɵadvance(24);\n            i0.ɵɵproperty(\"disabled\", ctx.saving);\n            i0.ɵɵadvance();\n            i0.ɵɵtextInterpolate1(\" \", ctx.saving ? \"Saving...\" : ctx.mode === \"create\" ? \"Create\" : \"Update\", \" \");\n          }\n        },\n        dependencies: [i4.NgIf, i1.ɵNgNoValidate, i1.NgSelectOption, i1.ɵNgSelectMultipleOption, i1.DefaultValueAccessor, i1.SelectControlValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.FormControlName, i2.RouterLink],\n        encapsulation: 2\n      });\n    }\n  }\n  return ClientFormPageComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}